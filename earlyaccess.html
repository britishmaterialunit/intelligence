<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Early Access</title>
  <style>
    body {
      background-color: #333333;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      color: white;
      font-family: sans-serif;
    }
    svg {
      width: 70%;
      height: auto;
      stroke: white;
      stroke-width: 1.5px;
      transition: none;
      cursor: pointer;
      transform: scale(1.2);
      transform-origin: center;
      margin-bottom: 30px;
    }
    .clickable-shape {
      fill: #333333; /* Default fill to match background */
      transition: fill 0.3s ease; /* Smooth fill transition */
    }
    .selected {
      fill: white !important; /* White fill when selected */
      stroke: white !important;
    }
    .buttons {
      margin-top: 40px;
      margin-bottom: 20px;
    }
    .buttons button {
      background: white;
      color: black;
      border: none;
      padding: 10px 20px;
      margin: 0 10px;
      cursor: pointer;
    }
    #infoText {
      margin-top: 20px;
      display: none;
      color: white;
      font-family: 'Helvetica'; /* Typewriter-like font */
      font-size: 16px;
      line-height: 1.5;
      text-align: left;
      max-width: 600px;
      white-space: pre-wrap; /* Preserve line breaks */
    }
    #carouselContainer {
      margin-top: 20px;
      display: none;
      text-align: center;
    }
    #carouselSvg {
      width: 200px; /* Smaller size for carousel */
      height: auto;
      margin: 0 auto;
    }
    #carouselSvg .clickable-shape {
      fill: white; /* Always white fill in carousel */
      stroke: white;
    }
    #carouselLabel {
      margin-top: 10px;
      font-family: sans-serif;
      font-size: 14px;
      color: white;
    }
  </style>
</head>
<body>

  <!-- Custom SVG with your shapes labeled from BA2000AOH01 to BA2000AOH28 -->
  <svg id="shapeContainer" viewBox="0 0 1920 1080">
    <defs>
      <style>
        .st0 {
          stroke: inherit;
          stroke-miterlimit: 10;
        }
      </style>
    </defs>
    
    <!-- Shape 1 -->
    <rect class="st0 clickable-shape" id="BA2000AOH01" x="701.65" y="316.02" width="22.31" height="133.86" transform="translate(-62.01 616.19) rotate(-45)"/>
    
    <!-- Shape 2 -->
    <rect class="st0 clickable-shape" id="BA2000AOH02" x="619.21" y="365.57" width="86.05" height="133.86" transform="translate(-111.86 594.95) rotate(-45)"/>
    
    <!-- Shape 3 -->
    <rect class="st0 clickable-shape" id="BA2000AOH03" x="740.18" y="315.05" width="19.12" height="105.18" transform="translate(-40.37 637.83) rotate(-45)"/>
    
    <!-- Shape 4 -->
    <rect class="st0 clickable-shape" id="BA2000AOH04" x="792.24" y="362.4" width="12.75" height="25.5" transform="translate(1628.6 75.71) rotate(135)"/>
    
    <!-- Shape 5 -->
    <rect class="st0 clickable-shape" id="BA2000AOH05" x="1108.42" y="355.88" width="12.75" height="25.5" transform="translate(587.18 -680.31) rotate(45)"/>
    
    <!-- Shape 6 -->
    <path class="st0 clickable-shape" id="BA2000AOH06" d="M776.41,595.15s-4.2-22.23-14.68-32.71l-48.42-48.42-9.01,9.01-9.01,9.01,48.42,48.42c10.48,10.48,32.71,14.68,32.71,14.68Z"/>
    
    <!-- Shape 7 -->
    <rect class="st0 clickable-shape" id="BA2000AOH07" x="912.71" y="816.77" width="54.18" height="5.1" transform="translate(1759.12 -120.48) rotate(90)"/>
    
    <!-- Shape 8 -->
    <rect class="st0 clickable-shape" id="BA2000AOH08" x="926.77" y="816.77" width="54.18" height="5.1" transform="translate(1773.18 -134.55) rotate(90)"/>
    
    <!-- Shape 9 -->
    <rect class="st0 clickable-shape" id="BA2000AOH09" x="954.91" y="816.77" width="54.18" height="5.1" transform="translate(1801.32 -162.68) rotate(90)"/>
    
    <!-- Shape 10 -->
    <rect class="st0 clickable-shape" id="BA2000AOH10" x="940.84" y="816.77" width="54.18" height="5.1" transform="translate(1787.25 -148.61) rotate(90)"/>
    
    <!-- Shape 11 -->
    <rect class="st0 clickable-shape" id="BA2000AOH11" x="968.98" y="816.77" width="54.18" height="5.1" transform="translate(1815.39 -176.75) rotate(90)"/>
    
    <!-- Shape 12 -->
    <rect class="st0 clickable-shape" id="BA2000AOH12" x="898.64" y="816.77" width="54.18" height="5.1" transform="translate(1745.05 -106.41) rotate(90)"/>
    
    <!-- Shape 13 -->
    <rect class="st0 clickable-shape" id="BA2000AOH13" x="772.49" y="898.41" width="379.28" height="63.74"/>
    
    <!-- Shape 14 -->
    <path class="st0 clickable-shape" id="BA2000AOH14" d="M727.97,651.46c11.88,11.88,32.06,13.2,32.06,13.2l29.89,3.68-200.58-200.58,3.68,29.89s1.32,20.18,13.2,32.06l121.75,121.75Z"/>
    
   <!-- Shape 15 -->
  <rect class="st0 clickable-shape" id="BA2000AOH15" x="1206.96" y="365.89" width="105.18" height="133.86" transform="translate(674.96 -763.87) rotate(45)"/>

    <!-- Shape 16 -->
    <path class="st0 clickable-shape" id="BA2000AOH16" d="M727.32,712.81l-99.84-99.83c-18.7,21.02-46.61,36.05-96.3,4.22-6.09-4.14-20.66-15.82-52.08-48.27-.59-.61-1.19-1.23-1.79-1.85-.37.72-.74,1.43-1.1,2.14-97.49,189.85,19.14,181.82,166.46,253.51,12.96-19.13,25.47-39.46,38.73-58.45,13.42-18.7,29.96-35.05,45.92-51.46Z"/>
    
    <!-- Shape 17 -->
    <path class="st0 clickable-shape" id="BA2000AOH17" d="M358,666.09s0,0,0,0h0Z"/>
    
    <!-- Shape 18 -->
    <path class="st0 clickable-shape" id="BA2000AOH18" d="M1001.65,463.42l3.13-22.49c9.19-55.16,7.23-136.26,7.23-136.26,0-51.22-9.19-103.75-9.19-103.75-5.58-29.88-5.25-92.92-5.25-92.92h-73.31s.33,63.04-5.25,92.92c0,0-9.19,52.53-9.19,103.75,0,0-1.97,81.1,7.23,136.26l3.13,22.49s9.89,1.55,40.75,1.55,40.75-1.55,40.75-1.55Z"/>
    
    <!-- Shape 19 -->
    <path class="st0 clickable-shape" id="BA2000AOH19" d="M1090.46,610.42c-.06-.92-.34-5.5-.37-5.96-1.47-28.08-17.69-69.13-19.9-84.37s-2.33-32.13-2.33-32.29h-28.65s.13,19.44,2.59,36.41c2.71,18.71,18.38,57.7,19.64,81.74.05,1.01.26,4.12.38,6.19.75,12.51-.36,57.59-53.3,71.72l7.4,27.72c75.74-20.22,75.3-88.51,74.54-101.16Z"/>
    
    <!-- Shape 20 -->
    <path class="st0 clickable-shape" id="BA2000AOH20" d="M831.34,610.42c.06-.92.34-5.5.37-5.96,1.47-28.08,17.69-69.13,19.9-84.37,2.29-15.78,2.33-32.13,2.33-32.29h28.65s-.13,19.44-2.59,36.41c-2.71,18.71-18.38,57.7-19.64,81.74-.05,1.01-.26,4.12-.38,6.19-.75,12.51.36,57.59,53.3,71.72l-7.4,27.72c-75.74-20.22-75.3-88.51-74.54-101.16Z"/>
    
    <!-- Shape 21 -->
    <path class="st0 clickable-shape" id="BA2000AOH21" d="M962.11,517.11c-44.89,0-81.27,36.39-81.27,81.27s36.39,81.27,81.27,81.27,81.27-36.39,81.27-81.27-36.39-81.27-81.27-81.27ZM962.11,660.53c-34.33,0-62.15-27.83-62.15-62.15s27.83-62.15,62.15-62.15,62.15,27.83,62.15,62.15-27.83,62.15-62.15,62.15Z"/>
    
    <!-- Shape 22 -->
    <rect class="st0 clickable-shape" id="BA2000AOH22" x="728.1" y="500.14" width="51" height="25.5" transform="translate(583.39 -382.65) rotate(45)"/>
    
    <!-- Shape 23 -->
    <rect class="st0 clickable-shape" id="BA2000AOH23" x="1188.08" y="308.41" width="22.31" height="133.86" transform="translate(1781.82 1488.75) rotate(-135)"/>
    
    <!-- Shape 24 -->
    <rect class="st0 clickable-shape" id="BA2000AOH24" x="1152.74" y="307.45" width="19.12" height="105.18" transform="translate(1729.58 1436.5) rotate(-135)"/>
    
    <!-- Shape 25 -->
    <path class="st0 clickable-shape" id="BA2000AOH25" d="M1151.83,602.5s4.2-22.23,14.68-32.71l48.42-48.42,9.01,9.01,9.01,9.01-48.42,48.42c-10.48,10.48-32.71,14.68-32.71,14.68Z"/>
    
    <!-- Shape 26 -->
    <path class="st0 clickable-shape" id="BA2000AOH26" d="M1200.27,658.81c-11.88,11.88-32.06,13.2-32.06,13.2l-29.89,3.68,200.58-200.58-3.68,29.89s-1.32,20.18-13.2,32.06l-121.75,121.75Z"/>
    
    <!-- Shape 27 -->
    <path class="st0 clickable-shape" id="BA2000AOH27" d="M1200.92,720.16l99.84-99.83c18.7,21.02,46.61,36.05,96.3,4.22,6.09-4.14,20.66-15.82,52.08-48.27.59-.61,1.19-1.23,1.79-1.85.37.72.74,1.43,1.1,2.14,97.49,189.85-19.14,181.82-166.46,253.51-12.96-19.13-25.47-39.46-38.73-58.45-13.42-18.7-29.96-35.05-45.92-51.46Z"/>
    
    <!-- Shape 28 -->
    <path class="st0 clickable-shape" id="BA2000AOH28" d="M961.61,725.42c-2.54,0-5.07.05-7.61.16-28.6,1.17-57.42,8.95-85.64,23.12-22.32,11.21-44.31,26.42-65.37,45.21-35.69,31.85-56.25,62.76-57.11,64.06l9.2,6.07,9.15,6.05c.2-.3,20.14-30.2,53.85-60.17,19.59-17.42,39.95-31.46,60.5-41.74,25.33-12.67,51.05-19.61,76.42-20.63,69.47-2.8,137.97,38.24,203.62,121.97l17.31-13.57c-19.06-24.31-38.69-45.52-58.36-63.04-18.63-16.6-37.78-30.32-56.91-40.79-32.4-17.73-65.69-26.7-99.05-26.7Z"/>
  </svg>

 <div class="buttons">
  <button onclick="toggleInfo()">!</button>
  <button onclick="resetShapes()">-</button>
  <button onclick="randomFill()">?</button>
  <button onclick="setAllShapes()">+</button>
  <button onclick="downloadSelectedSVGs()">▼</button>
  
</div>

  <div id="infoText"></div>
  <div id="carouselContainer">
    <svg id="carouselSvg"></svg>
    <div id="carouselLabel"></div>
  </div>

  <script>
  const totalShapes = 28;
  const selectedShapes = new Set();
  const infoText = document.getElementById('infoText');
  const carouselContainer = document.getElementById('carouselContainer');
  const carouselSvg = document.getElementById('carouselSvg');
  const carouselLabel = document.getElementById('carouselLabel');
  const infoContent = `Contractor: Typhoon International Limited
Date of Manufacture: 2000s
Nationality: British; Modular Hood (Linked to Multiple NSNs) ∴ possibly non-exclusive to British Military
Era of War: N/A (SAS 21st Century Operations; used in Royal Air Force (RAF) United Kingdom Special Forces (UKSF) Special Air Service (SAS) “Amphibious Operations”)
Pattern Pieces: 27
Additional Components: Zippers (2) Velcro (2) Wire (1) Cords w/ Stoppers (2) Fasteners (2)
Additional Provenance: Purchased from RicAndre42 selling via eBay (June, 2024)
Status: Discontinued/Surplus`;
  let isTyping = false;
  let typewriterInterval = null;
  let carouselInterval = null;
  let currentCarouselIndex = -1;
  let lastSelectedShape = null;

  // Add click listeners to all shapes
  for (let i = 1; i <= totalShapes; i++) {
    const id = `BA2000AOH${String(i).padStart(2, '0')}`;
    const el = document.getElementById(id);
    if (el) {
      el.addEventListener('click', () => toggleShape(el));
    }
  }

  function toggleShape(el) {
    el.classList.toggle('selected');
    const id = el.id;
    if (el.classList.contains('selected')) {
      selectedShapes.add(id);
      lastSelectedShape = id; // Track the last selected shape
    } else {
      selectedShapes.delete(id);
      if (lastSelectedShape === id) lastSelectedShape = null; // Clear if deselected
    }
    updateCarousel();
  }

  function resetShapes() {
    // Deselect all shapes
    document.querySelectorAll('.clickable-shape').forEach(shape => {
      shape.classList.remove('selected');
      shape.style.fill = '#333333'; // Reset to original fill
    });
    selectedShapes.clear();
    lastSelectedShape = null;
    updateCarousel(); // Update carousel to hide if no shapes are selected
  }

  function setAllShapes() {
    // Select and animate all shapes
    document.querySelectorAll('.clickable-shape').forEach(shape => {
      if (!shape.classList.contains('selected')) {
        shape.classList.add('selected');
        selectedShapes.add(shape.id);
        // Trigger reflow to restart CSS animation
        shape.style.transition = 'none';
        shape.style.fill = '#333333';
        shape.offsetHeight; // Force reflow
        shape.style.transition = 'fill 0.3s ease';
        shape.style.fill = 'white';
      }
    });
    lastSelectedShape = `BA2000AOH${String(totalShapes).padStart(2, '0')}`; // Set last shape for carousel
    updateCarousel();
  }

  function toggleInfo() {
    if (infoText.style.display === 'block') {
      // Stop typing and carousel, hide elements
      clearInterval(typewriterInterval);
      clearInterval(carouselInterval);
      infoText.style.display = 'none';
      carouselContainer.style.display = 'none';
      infoText.textContent = '';
      carouselSvg.innerHTML = '';
      carouselLabel.textContent = '';
      isTyping = false;
      currentCarouselIndex = -1;
      return;
    }

    // Start typewriter effect
    infoText.style.display = 'block';
    infoText.textContent = '';
    let index = 0;
    isTyping = true;

    typewriterInterval = setInterval(() => {
      if (index < infoContent.length) {
        infoText.textContent += infoContent[index];
        index++;
      } else {
        clearInterval(typewriterInterval);
        isTyping = false;
      }
    }, 10); // Faster typewriter effect (10ms per character)

    // Start carousel if there are selected shapes
    if (selectedShapes.size > 0) {
      carouselContainer.style.display = 'block';
      updateCarousel();
      startCarousel();
    }
  }

  function updateCarousel() {
    if (selectedShapes.size === 0) {
      carouselContainer.style.display = 'none';
      carouselSvg.innerHTML = '';
      carouselLabel.textContent = '';
      clearInterval(carouselInterval);
      return;
    }

    // If a shape was just selected, show it immediately on the next cycle
    if (lastSelectedShape && selectedShapes.has(lastSelectedShape)) {
      currentCarouselIndex = [...selectedShapes].indexOf(lastSelectedShape) - 1; // Adjust to show it next
    }

    // Ensure carousel is running if infoText is visible
    if (infoText.style.display === 'block') {
      carouselContainer.style.display = 'block';
      if (!carouselInterval) startCarousel();
    }
  }

  function startCarousel() {
    clearInterval(carouselInterval); // Clear existing interval to prevent duplicates
    carouselInterval = setInterval(() => {
      if (selectedShapes.size === 0) {
        carouselContainer.style.display = 'none';
        carouselSvg.innerHTML = '';
        carouselLabel.textContent = '';
        clearInterval(carouselInterval);
        return;
      }

      // Move to next shape
      currentCarouselIndex = (currentCarouselIndex + 1) % selectedShapes.size;
      const shapeIds = [...selectedShapes];
      const currentId = shapeIds[currentCarouselIndex];
      const shape = document.getElementById(currentId);

      if (shape) {
        // Clone the shape and display it
        carouselSvg.innerHTML = '';
        const clonedShape = shape.cloneNode(true);
        clonedShape.classList.add('clickable-shape');
        carouselSvg.appendChild(clonedShape);
        carouselLabel.textContent = currentId;
      }
    }, 1000); // 1-second interval
  }

  function randomFill() {
    // Clear all selections
    document.querySelectorAll('.clickable-shape').forEach(shape => {
      shape.classList.remove('selected');
      shape.style.fill = '#333333'; // Reset fill
    });
    selectedShapes.clear();
    lastSelectedShape = null;

    // Get random count using weighted distribution
    const count = weightedRandom([2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 24], [1, 2, 4, 6, 8, 10, 8, 6, 4, 2, 1]);

    // Randomly select shapes
    const indices = [...Array(totalShapes).keys()].sort(() => 0.5 - Math.random()).slice(0, count);
    for (const i of indices) {
      const id = `BA2000AOH${String(i + 1).padStart(2, '0')}`;
      const el = document.getElementById(id);
      if (el) {
        toggleShape(el);
        lastSelectedShape = id; // Set last selected for immediate display
      }
    }
    updateCarousel();
  }

  function weightedRandom(values, weights) {
    let total = weights.reduce((a, b) => a + b);
    let rand = Math.random() * total;
    for (let i = 0; i < values.length; ++i) {
      if (rand < weights[i]) return values[i];
      rand -= weights[i];
    }
  }

  function downloadSelectedSVGs() {
    if (selectedShapes.size === 0) {
      alert('No shapes selected for download.');
      return;
    }

    const svg = document.getElementById('shapeContainer').cloneNode(true);

    // Remove unselected shapes
    svg.querySelectorAll('.clickable-shape').forEach(el => {
      if (!selectedShapes.has(el.id)) {
        el.remove();
      }
    });

    // Create downloadable SVG
    const svgString = '<?xml version="1.0" encoding="UTF-8"?>\n' + svg.outerHTML;
    const blob = new Blob([svgString], { type: 'image/svg+xml' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'selected_shapes.svg';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }
</script>
</body>
</html>
